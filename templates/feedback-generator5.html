<link href="/static/css/feedback-generator.css" rel="stylesheet">

{% extends "layout-tabs.html" %}

{% block tabs %}
<div class="tab-feedback-generator">
    <label for="file">Magic in progress:</label>
    <progress id="file" value="32" max="100"> 32% </progress>
    <label for="file">Doc 1/10</label>
    <form action="/show-text-assignments3" method="POST" id="form"></form>
    <div name="[18,15]" id="barra_de_progreso_por_semana" id="canvas_container" >
    </div>
    <p>Counter Semaphore Value: <span id="counterValue"></span>/<span id="doc_number"></span></p>
</div>
<script src="/static/js/assignmentReader.js"></script>

<script>
    // Automatically submit the form when the page loads
    window.onload = function() {
        document.getElementById("myForm").submit();
    };
</script>
<script>
    // Function to fetch counter semaphore value
    async function fetchCounterSemaphoreValue() {
        try {
            const response = await fetch('/get-counter-semaphore');
            const data = await response.json();
            document.getElementById('counterValue').textContent = data.counter_semaphore_value;
            document.getElementById('doc_number').textContent = data.doc_number;
            console.log(data.counter_semaphore_value);
            // crea_canvas("barra_de_progreso_por_semana",data.doc_number,data.counter_semaphore_value)
        } catch (error) {
            console.error('Error fetching counter semaphore value:', error);
        }
    }

    // Initial fetch
    fetchCounterSemaphoreValue();

    // Periodically update counter semaphore value
    setInterval(fetchCounterSemaphoreValue, 100); //
</script>

{% endblock %}